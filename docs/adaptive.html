<!-- template for the static html pages not generated by build e.g., index, guidance , toc -->

<!DOCTYPE HTML>

<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
   <meta charset="UTF-8"/>
  <title>Argonaut Questionnaire</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="Argonaut Questionnaire Implemenation Guide" />
<meta name="author" content="Argonaut Project"/>
  <link href="fhir.css" rel="stylesheet"/>


   <!-- Bootstrap core CSS -->

   <!-- Latest compiled and minified CSS -->

  <link href="assets/css/bootstrap.css" rel="stylesheet"/>
  <link href="assets/css/bootstrap-fhir.css" rel="stylesheet"/>
  <link href="assets/css/bootstrap-glyphicons.css" rel="stylesheet"/>

  <!-- Project extras -->
  <link href="assets/css/project.css" rel="stylesheet"/>
  <link href="assets/css/pygments-manni.css" rel="stylesheet"/>
	<link href="assets/css/jquery-ui.css" rel="stylesheet"/>




  <!-- Favicons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="assets/ico/apple-touch-icon-144-precomposed.png"/>
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="assets/ico/apple-touch-icon-114-precomposed.png"/>
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="assets/ico/apple-touch-icon-72-precomposed.png"/>
  <link rel="apple-touch-icon-precomposed" href="assets/ico/apple-touch-icon-57-precomposed.png"/>
  <link rel="shortcut icon" href="assets/ico/favicon.png"/>


<body markdown="1">
<?xml version="1.0" encoding="UTF-8"?>
<div id="segment-header" class="segment">
  <!-- segment-header -->
  <div class="container"><!-- container -->

<!-- hl7 logo -->
    <a no-external="true" href="http://hl7.org/fhir">
      <img alt="FHIR Homepage" class="img-responsive logo" src="assets/images/fhir-logo-www.png"/>
    </a>
<!-- end hl7 logo -->


 <!-- org logo -->
             <!--
<a id="your-logo" no-external="true" href="http://www.hl7.org">
<img height="50" alt="visit the hl7 website" width="42" src="assets/images/hl7-logo.png"/>
</a>

================THIS IS FOR THE PROJECT LOGO AND URL ===============
-->

<a no-external="true" href="http://argonautwiki.hl7.org">
<img alt="visit our website" class="img-responsive project-logo" src="assets/images/ArgonautProject_logo_black.png"/>
</a>

  <!-- end org logo -->


      <div id="project-status" class="project-status"> <!-- ig title text -->
        <b>Argonaut Questionnaire Implementation Guide</b>
        
        CI Build
        
    </div><!-- end ig title text -->

  </div><!-- end container -->
  <div class="container">
    <!-- container -->
  </div>
</div>
<!-- /segment-header -->


<div id="segment-navbar" class="segment">
  <!-- segment-navbar -->
  <div id="stripe">
  </div>
  <div class="container">
    <!-- container -->
    <!-- HEADER CONTENT -->
    <nav class="navbar navbar-inverse">
      <div class="container">
        <button data-target=".navbar-inverse-collapse" class="navbar-toggle" data-toggle="collapse" type="button">
          <span class="icon-bar">
          </span>
          <span class="icon-bar">
          </span>
          <span class="icon-bar">
          </span>
        </button>
        <a class="navbar-brand hidden" href="http://hl7.org/fhir/STU3/index.html">FHIR</a>
        <div class="nav-collapse collapse navbar-inverse-collapse">

       
<!--{:.nav .navbar-nav} don't remove the line above - to add or remove a menu item commeent in or out - [Home](index.html)- [Use Cases...](guidance.html){: .dropdown-toggle data-toggle="dropdown"}  - [Patient Based Scheduling](patient-scheduling.html)  - [Provider based Scheduling](provider-scheduling.html)  {: .dropdown-menu}- [Operations](operations.html)- [Profiles/Extensions](profiles.html)- [Terminology](terminology.html)- [Capability Statements...](capstatements.html){: .dropdown-toggle data-toggle="dropdown"}  - [Conformance requirements for Server](CapabilityStatement-server.html)  - [Conformance requirements for Client](client-capstatement.html)  {: .dropdown-menu}- [Downloads](downloads.html)-->
<ul class="nav navbar-nav">
  <li>
    <a href="index.html">Home</a>
  </li>
<!--
  <li>
    <a href="guidance.html">Guidance</a>
  </li>
-->
  <li class="dropdown">
    <a href="#" data-toggle="dropdown" class="dropdown-toggle">Use Cases<b class="caret">
    </b>
  </a>
  <ul class="dropdown-menu">
    <li>
      <a href="static.html">Static Forms</a>
    </li>
    <li>
      <a href="adaptive.html">Adaptive Forms</a>
    </li>
  </ul>
</li>
<!--
<li>
  <a href="operations.html">Operations</a>
</li>
-->
<li>
  <a href="profiles.html">Profiles and Operations</a>
</li>
<!--
<li>
  <a href="terminology.html">Terminology</a>
</li>
-->
<li>
  <a href="searchparameters.html">Search Parameters</a>
</li>
<li class="dropdown">
  <a href="#" data-toggle="dropdown" class="dropdown-toggle">Capability Statements<b class="caret">
  </b>
</a>
<ul class="dropdown-menu">
<li>
  <a href="CapabilityStatement-assessmentbank.html">Conformance requirements for Assessment Bank</a>
</li>
<li>
  <a href="CapabilityStatement-answerbank.html">Conformance requirements for Answer Bank</a>
</li>

  <li>
    <a href="CapabilityStatement-argo-questionnaire-provider-ehr.html">Conformance requirements for Provider EHR</a>
  </li>
  <!--
  <li>
    <a href="CapabilityStatement-argonaut-questionnaire-client.html">Conformance requirements for Client</a>
  </li>
  -->
  <li>
    <a href="CapabilityStatement-adaptive-questionnaire-service.html">Conformance requirements for Adaptive Questionnaire Service</a>
  </li>
</ul>
</li>
<li>
  <a href="downloads.html">Downloads</a>
</li>
</ul>


      </div>
      <!-- /.nav-collapse -->
    </div>
    <!-- /.container -->
  </nav>
  <!-- /.navbar -->
  <!-- /HEADER CONTENT -->
</div>
<!-- /container -->
</div>
<!-- /segment-navbar -->


</div>  <!-- /container -->
</div>  <!-- /segment-breadcrumb -->


<div id="page-content-wrapper">  <!-- page content wrapper -->
  <div class="page-content">  <!--page content -->
    <div class="container">  <!-- container -->
      <div class="row">  <!-- row -->
       <div class="inner-wrapper"> <!-- inner-wrapper -->
         <div class="col-12">  <!--col -->
            <!-- content of page -->








  <style type="text/css">
  h2,h3,h4,h5,h6{--pagenumber: "2.2"}
  </style>



<!-- ============BreadCrumb=============== -->

<nav class="breadcrumb">
  
    <a class="breadcrumb-item btn btn-link btn-sm" href="toc.html">TOC</a> <li><a href='index.html'><b>Home</b></a></li><li><a href='guidance.html'><b>General Guidance</b></a></li><li><b>Adaptive</b></li>
</nav>


<!-- ============StatusBox=============== -->

<!--status-bar-->
<p id="publish-box">
This is the 
    Continuous Integration Build
   
  
  of the Argonaut Questionnaire Implementation Guide,  based on <a href="http://hl7.org/fhir/STU3/index.html">FHIR Version 3.0.1</a>.  See the <a href="#">Directory of published versions.</a>
</p>


<!-- ============CONTENT CONTENT=============== -->


<h2>Adaptive Forms</h2>

<!-- page source: adaptive.md  -->




<!-- TOC  the css styling for this is \pages\assets\css\project.css under 'markdown-toc'-->

<ul id="markdown-toc">
  <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li>
  <li><a href="#assumptions-and-precondition" id="markdown-toc-assumptions-and-precondition">Assumptions and Precondition</a></li>
  <li><a href="#workflow-steps" id="markdown-toc-workflow-steps">Workflow Steps</a>    <ul>
      <li><a href="#discovery-of-adaptive-questionnaire" id="markdown-toc-discovery-of-adaptive-questionnaire">Discovery of Adaptive Questionnaire</a></li>
      <li><a href="#initiate-adaptive-questionnaire" id="markdown-toc-initiate-adaptive-questionnaire">Initiate Adaptive Questionnaire</a></li>
      <li><a href="#get-next-question" id="markdown-toc-get-next-question">Get Next Question</a></li>
      <li><a href="#adaptive-questionnaire-is-complete" id="markdown-toc-adaptive-questionnaire-is-complete">Adaptive Questionnaire is Complete</a></li>
      <li><a href="#questionnaireresponse-and-scoring" id="markdown-toc-questionnaireresponse-and-scoring">QuestionnaireResponse and Scoring</a></li>
      <li><a href="#examples-and-reference-implementation" id="markdown-toc-examples-and-reference-implementation">Examples and Reference Implementation</a></li>
      <li><a href="#amending-and-revising-adaptive-forms" id="markdown-toc-amending-and-revising-adaptive-forms">Amending and Revising Adaptive Forms</a></li>
    </ul>
  </li>
</ul>

<h2 id="introduction">Introduction</h2>

<p>The Argonaut Questionnaire Implementation Guide defines a series of interactions which cover the basic workflow for the creation, discovery and retrieval of “<strong>computer adaptive forms</strong>” using FHIR Questionnaire and QuestionnaireResponse and
 the FHIR API.  The reader is encouraged to familiarize herself with the capabilities of the Questionnaire and QuestionnaireResponse Response resources by reviewing the guidance given in the FHIR specification and the guidance in <a href="static.html">Static Forms Use Case</a>.</p>

<p>Argonaut Questionnaire Adaptive forms are dynamic forms that adjust what questions are asked based on previous answers. This is also known as Computerized Adaptive Testing (CAT). The logic to determine the questions are defined external to the Questionnaire resource.<sup id="fnref:5"><a href="#fn:5" class="footnote">1</a></sup>   Responses to questions are iteratively submitted to a <a href="http://hl7.org/fhir/STU3/operations.html">FHIR operation</a> endpoint and the contained Questionnaire and QuestionnaireResponse resources are updated on the fly.  A score based on responses may calculate and recorded separately (e.g., a FHIR <a href="http://hl7.org/fhir/STU3/observation.html" title="Observation resource">Observation</a>) or as part of the QuestionnaireResponse.</p>

<p>See the <a href="http://www.healthmeasures.net/index.php?option=com_content&amp;view=category&amp;layout=blog&amp;id=164&amp;Itemid=1133" title="HealthMeasures (also known as the Person-Centered Assessment Resource) is a grant from the National Institutes of Health (NIH) to expand and automate use of four state-of-the-science measurement systems: PROMIS®, NIH Toolbox®, Neuro-QoL, and ASCQ-Me®.">HealthMeasures</a> website for further background, theory and use cases for adaptive forms.</p>

<h2 id="assumptions-and-precondition">Assumptions and Precondition</h2>

<ol>
  <li>The Adaptive Questionnaire Service is treated as a <strong>“Black Box”</strong>. It contains the logic for determination of next question and scoring. Form Fillers make RESTful FHIR transactions on Service using a <em>FHIR operation</em> and pass QuestionnaireResponse with <a href="http://hl7.org/fhir/STU3/references.html#contained">contained</a> Questionnaire as the payload to capture the data needed between the Form Filler and Service</li>
  <li>Transactions are Stateless.  The Form Filler constructs a record of the transaction which is passed to service and the service adds to record and passed it back to Form Filler.  The Form Filler and service are free of keeping track of the session and a previously disrupted session can be restored if the session token expires.</li>
  <li>The Questionnaire may expire and the form may not be valid. Time limits for completion of a questionnaire or individual question can be defined and the Form Filler Application can record the start and stop date-times using the <a href="StructureDefinition-extension-timeLimit.html">Argonaut Questionnaire Time Limit Extension</a> and <a href="StructureDefinition-extension-responsePeriod.html" title="The start and stop date-times for completing a questionnaire or a questionnnaire item or group.">Argonaut QuestionnaireResponse Response Period Extension</a>.  Note that either Form Filler or Service could determine if the response is within a time limit. How this information modifies the behavior of the Form-filler or interpretation of results is an implementation detail outside of scope of this Implementation Guide.</li>
  <li>The assessment  are short - e.g., PROMIS forms have up to 12 transactions  (on average 4-12).</li>
  <li>The service may calculate and record scores in the QuestionnaireResponse resource as “answers” to a “score” question item in the Questionnaire.  The score item is flagged as <a href="http://hl7.org/fhir/STU3/questionnaire-definitions.html#Questionnaire.item.readOnly" title="An indication, when true, that the value cannot be changed by a human respondent to the Questionnaire."><code class="highlighter-rouge">readOnly</code></a> and may be marked as <em>hidden</em> using the <a href="http://hl7.org/fhir/STU3/extension-questionnaire-hidden.html" title="Questionnaire hidden extension: If true, indicates that the extended item should not be displayed to the user.">Questionnaire Hidden Extension</a> to direct the Form Filler that the item should not be displayed to the user.
    <ul>
      <li>To assist in calculating scores the standard <a href="http://hl7.org/fhir/STU3/extension-valueset-ordinalvalue.html" title="ValueSet ordinalvalue extension: A numeric value that allows numerical manipulation of a concept.">ValueSet Ordinal Value Extension</a> and <a href="http://hl7.org/fhir/STU3/extension-questionnaire-ordinalvalue.html" title="A numeric value that allows the comparison (less than, greater than) or other numerical manipulation of a concept (e.g. adding up components of a score).">Questionnaire Ordinal Value Extension</a> may be used on items. <em>NOTE: This implementation guide extends the context of the Questionnaire Ordinal Value Extension to elements beyond that defined in the FHIR Specification.</em></li>
      <li>How and when scoring is done is an implementation detail and outside the scope of this guide.</li>
    </ul>
  </li>
  <li>The <a href="StructureDefinition-extension-itemOrder.html" title="An integer representing the order of questions within Questionnaires groups, groups within groups and groups within questions and the order of answer choices for questions of type ‘choice’ and ‘open-choice using Questionnaire.item.option.">Argonaut Questionnaire Item Order Extension</a> and <a href="http://hl7.org/fhir/STU3/extension-valueset-conceptorder.html" title="Identifies the relative order in which concepts within the value set should be presented to a user.">conceptOrder</a> extension may be used by the service to ensure the relative order of Questionnaire items is maintained between transactions.</li>
  <li>There are no constraints on the nesting of item groups and there are several possible items and item groupings including:
    <ul>
      <li><em>a single</em> question (‘what is the capital of Assyria?’) or</li>
      <li><em>a single</em> display  (‘Answer these questions three!!’) or</li>
      <li><em>a single</em> item group of <em>multiple</em> display + <em>multiple</em> questions  ( ‘what is you favorite color?’, ‘what is the capital of Assyria?’, ‘what is average flight speed of a laden swallow?’)
        <ul>
          <li>or a group containing the question-score pairs when transmitting an individual score for each item.</li>
        </ul>
      </li>
      <li><em>a single</em> item group of: <em>multiple</em> item groups (‘Answer these questions three!!’, ‘what is you favorite color?’, ‘what is the capital of Assyria?’, ‘what is average flight speed of a laden swallow?’)</li>
    </ul>
  </li>
</ol>

<h2 id="workflow-steps">Workflow Steps</h2>

<p>The following sections provide a detailed description of workflow and API guidance for the Adaptive Forms Use Case.</p>

<h3 id="discovery-of-adaptive-questionnaire">Discovery of Adaptive Questionnaire</h3>

<p>The discovery process yields a url that identifies the the set of questions for a particular adaptive questionnaire.  The url is included in the <em>contained</em> Questionnaire data so that the Adaptive Questionnaire Service is able to identify which set of questions are being requested.</p>

<p>How the discovery and preview of the service’s adaptive questionnaire is done is out of scope.  It may be done out of band or using the standard <a href="http://hl7.org/fhir/STU3/search.html">FHIR RESTful search API</a>.</p>

<!--------- INIT ------------>

<h3 id="initiate-adaptive-questionnaire">Initiate Adaptive Questionnaire</h3>

<!-- all this Bootstrap html for getting an image to fit nicely in text - 640 pix wide -->

<!-- file:///assets/images/aw-step1.jpg -->

<div>
<figure class="figure">
<figcaption class="figure-caption"><strong></strong></figcaption>
  <img src="assets/images/aw-step1.jpg" class="figure-img-narrow img-responsive img-rounded center-block" alt="aw-step1.jpg" />
</figure>

<p></p>
</div>

<p>To launch the adaptive questionnaire the Form Filler POSTs the operation <code class="highlighter-rouge">$next-question</code> to the Adaptive Questionnaire Service (“Black Box”) instance endpoint.  A QuestionnaireResponse with a <em>contained</em> Questionnaire representing only the resource metadata is provided as payload data.</p>

<!-- all this Bootstrap html for getting an image to fit nicely in text - 640 pix wide -->

<!-- file:///assets/images/aqr_diagrams_a.svg -->

<div>
<figure class="figure">
<figcaption class="figure-caption"><strong></strong></figcaption>
  <img src="assets/images/aqr_diagrams_a.svg" class="figure-img-narrow img-responsive img-rounded center-block" alt="aqr_diagrams_a.svg" />
</figure>

<p></p>
</div>

<p>The Service updates the contained Questionnaire with the first item and returns the QuestionnaireResponse in the payload.</p>

<!-- all this Bootstrap html for getting an image to fit nicely in text - 640 pix wide -->

<!-- file:///assets/images/aqr_diagrams_b.svg -->

<div>
<figure class="figure">
<figcaption class="figure-caption"><strong></strong></figcaption>
  <img src="assets/images/aqr_diagrams_b.svg" class="figure-img-narrow img-responsive img-rounded center-block" alt="aqr_diagrams_b.svg" />
</figure>

<p></p>
</div>

<h4 class="no_toc" id="apis">APIs</h4>

<p>The following Argonaut Questionnaire artifacts are used in this transaction:</p>

<ul>
  <li><strong><a href="OperationDefinition-next-question.html" title="The Argonaut Next Question Operation is used for adaptive questionnaires forms where the next question is based on previous answers.">Argonaut Next Question Operation</a></strong></li>
  <li><strong><a href="StructureDefinition-argo-adap-questionnaireresponse.html" title="The Argonaut Adaptive QuestionnaireResponse Profile  is derived from the Argonaut QR profile requiring a containedArgonaut Questionnaire Profile to support the adaptive questionnaire use case.">Argonaut Adaptive QuestionnaireResponse Profile</a></strong></li>
</ul>

<h4 class="no_toc" id="usage">Usage</h4>

<p>To initiate an  adaptive questionnaire:</p>

<p><code class="highlighter-rouge">POST [base]/Questionnaire/$next-question</code></p>

<p>
  <button class="btn-sm btn-info" type="button" title="Click to Open or Close Example" data-toggle="collapse" data-target="#example-aq-initiate" aria-expanded="false" aria-controls="collapseExample">
    Example: $next-question Operation Initiates Adaptive Questionnaire and Returns First Group Item
  </button>
</p>

<div class="collapse" id="example-aq-initiate">
  <div class="card card-body">
      <p>Note that these json examples are annotated with nonstandard comments and snipped for brevity.</p>

<p><strong>request</strong></p>

<p><code class="highlighter-rouge">POST [base]/Questionnaire/questionnaire-example-adaptive-sampler/$next-question</code></p>

<p><strong>payload</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> {
    "resourceType": "QuestionnaireResponse",
    "id": "questionnaireresponse-example-adaptive-sampler",
    "meta": {
      "profile": [
        "http://fhir.org/guides/argonaut-questionnaire/StructureDefinition/argo-adap-questionnaireresponse"
      ],
    //COMMENT - contained Questionnaire
    "contained": [
      {
        "resourceType": "Questionnaire",
        "id": "questionnaire-example-adaptive-sampler",
        "meta": {
          "profile": [
            "http://fhir.org/guides/argonaut-questionnaire/StructureDefinition/argo-questionnaire"
          ]
        },
        "url": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler",
        "title": "Argonaut Questionnaire Sampler",
        "status": "draft",
        //COMMENT - no items since initiating the adaptive questionnaire
      ...[snipped for brevity]....
      }
    ]
    },
    //COMMENT - references the contained Questionnaire
    "questionnaire": {
      "reference": "#questionnaire-example-adaptive-sampler"
    },
    "status": "in-progress",
   ..[snipped for brevity]....
   //COMMENT - no items since is just getting started
   }
  }
</code></pre></div></div>

<p><strong>response</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "resourceType": "QuestionnaireResponse",
  "id": "questionnaireresponse-example-adaptive-sampler",
  "meta": {
    "profile": [
      "http://fhir.org/guides/argonaut-questionnaire/StructureDefinition/argo-adap-questionnaireresponse"
    ],
  //COMMENT - contained Questionnaire
  "contained": [
    {
      "resourceType": "Questionnaire",
      "id": "questionnaire-example-adaptive-sampler",
      "meta": {
        "profile": [
          "http://fhir.org/guides/argonaut-questionnaire/StructureDefinition/argo-questionnaire"
        ]
      },
      //COMMENT - the 'url' element identifies the adaptive questionnaire - the set of questions for a particular adaptive questionnaire
      "url": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler",
      "title": "Argonaut Questionnaire Sampler",
      "status": "draft",
      ...[snipped for brevity]....
      //add first item group which is a display only not a questions
      "item": [
      {
        "linkId": "g1",
        // unique url for the Server to identify the adaptive questionnaire question for processing (figure out what is the next question and/or calculating the score) this could also be a GUID
        "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g1"
        "text": "Header Text",
        "type": "group",
        "required": true,
        "item": [
          {
            "linkId": "g1.d",
            // unique url for the Server to identify the adaptive questionnaire question for processing  (figure out what is the next question and/or calculating the score)
            "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g1.d1"
            "text": "The Argonaut Questionnaire Sampler is designed to show all the question types that can be used in the Argonaut Questionnaire Project:\n\n1 boolean\n2 decimal\n3 integer\n4 dateDate\n5 dateTime\n6 timeTime\n7 string\n8 textText\n9 urlUrl\n10 choice\n11 open-choice\n12 quantity\n",
            "type": "display",
            "required": true
          }
        ]
      }
     ]
    }
  ]
  },
  //COMMENT - reference to contained Questionnaire
  "questionnaire": {
    "reference": "#questionnaire-example-adaptive-sampler"
  },
  "status": "in-progress",
...[snipped for brevity]....
//COMMENT - no items since is just getting started
}
</code></pre></div></div>

  </div>
</div>
<p><br /></p>

<!--------- NEXT Q - 1 ------------>

<h3 id="get-next-question">Get Next Question</h3>

<!-- all this Bootstrap html for getting an image to fit nicely in text - 640 pix wide -->

<!-- file:///assets/images/aw-step2.jpg -->

<div>
<figure class="figure">
<figcaption class="figure-caption"><strong></strong></figcaption>
  <img src="assets/images/aw-step2.jpg" class="figure-img-narrow img-responsive img-rounded center-block" alt="aw-step2.jpg" />
</figure>

<p></p>
</div>

<p>The Form Filler renders the item, presents it to the end-user and records the response in the QuestionnaireResponse.  The Form Filler POSTs the operation <code class="highlighter-rouge">$next-question</code> to the Service to retrieve the next question.</p>

<!-- all this Bootstrap html for getting an image to fit nicely in text - 640 pix wide -->

<!-- file:///assets/images/aqr_diagrams_c.svg -->

<div>
<figure class="figure">
<figcaption class="figure-caption"><strong></strong></figcaption>
  <img src="assets/images/aqr_diagrams_c.svg" class="figure-img-narrow img-responsive img-rounded center-block" alt="aqr_diagrams_c.svg" />
</figure>

<p></p>
</div>

<p>As result of the operation, the Service updates the Questionnaire and returns it to the Form Filler.  It identifies the adaptive questionnaire items by their <code class="highlighter-rouge">definition</code> or <code class="highlighter-rouge">linkID</code> elements and determines the next question based on the responses.  It may also calculate intermediate and/or cumulative scores. The Service updates the contained Questionnaire with the next question and scores if scoring is done and returns it within the QuestionnaireResponse.</p>

<!-- all this Bootstrap html for getting an image to fit nicely in text - 640 pix wide -->

<!-- file:///assets/images/aqr_diagrams_d.svg -->

<div>
<figure class="figure">
<figcaption class="figure-caption"><strong></strong></figcaption>
  <img src="assets/images/aqr_diagrams_d.svg" class="figure-img-narrow img-responsive img-rounded center-block" alt="aqr_diagrams_d.svg" />
</figure>

<p></p>
</div>

<p>This step is repeated until the adaptive questionnaire is done or the Questionnaire has timed out or another error has occurred.</p>

<h4 class="no_toc" id="apis-1">APIs</h4>

<p>The following Argonaut Questionnaire artifacts are used in this transaction:</p>

<ul>
  <li><strong><a href="OperationDefinition-next-question.html" title="The Argonaut Next Question Operation is used for adaptive questionnaires forms where the next question is based on previous answers.">Argonaut Next Question Operation</a></strong></li>
  <li><strong><a href="StructureDefinition-argo-adap-questionnaireresponse.html" title="The Argonaut Adaptive QuestionnaireResponse Profile  is derived from the Argonaut QR profile requiring a containedArgonaut Questionnaire Profile to support the adaptive questionnaire use case.">Argonaut Adaptive QuestionnaireResponse Profile</a></strong></li>
</ul>

<h4 class="no_toc" id="usage-1">Usage</h4>

<p>To retrieve the next question:</p>

<p><code class="highlighter-rouge">POST [base]/Questionnaire/$next-question</code></p>

<p>
  <button class="btn-sm btn-info" type="button" title="Click to Open or Close Example" data-toggle="collapse" data-target="#example-aq-next1" aria-expanded="false" aria-controls="collapseExample">
    Example: $next-question Operation Returns Next Question
  </button>
</p>

<div class="collapse" id="example-aq-next1">
  <div class="card card-body">
      <p>Note that these json examples are annotated with nonstandard comments and snipped for brevity.</p>

<p><strong>request</strong></p>

<p><code class="highlighter-rouge">POST [base]/Questionnaire/questionnaire-example-adaptive-sampler/$next-question</code></p>

<p><strong>payload</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{"resourceType": "QuestionnaireResponse",
      "id": "questionnaireresponse-example-adaptive-sampler",
      "meta": {
        "profile": [
          "http://fhir.org/guides/argonaut-questionnaire/StructureDefinition/argo-adap-questionnaireresponse"
        ],
      //COMMENT - contained Questionnaire
      "contained": [
        {
          "resourceType": "Questionnaire",
          "id": "questionnaire-example-adaptive-sampler",
          "meta": {
            "profile": [
              "http://fhir.org/guides/argonaut-questionnaire/StructureDefinition/argo-questionnaire"
            ]
          },
          //COMMENT -the 'url' element identifies the adaptive questionnaire - the set of questions for a particular adaptive questionnaire
          "url": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler",
          "title": "Argonaut Questionnaire Sampler",
          "status": "draft",
          ...[snipped for brevity]....
          //COMMENT -first item group is a display only
          "item": [
          {
            "linkId": "g1",
            //COMMENT - unique url for the Server to identify the adaptive questionnaire question for processing  (figure out what is the next question and/or calculating the score) this could also be a GUID.
            "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g1"
            "text": "Header Text",
            "type": "group",
            "required": true,
            "item": [
              {
                "linkId": "g1.d",
                //COMMENT - unique url for the Server to identify the adaptive questionnaire question for processing  (figure out what is the next question and/or calculating the score)
                "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g1.d"
                "text": "The Argonaut Questionnaire Sampler is designed to show all the question types that can be used in the Argonaut Questionnaire Project:\n\n1 boolean\n2 decimal\n3 integer\n4 dateDate\n5 dateTime\n6 timeTime\n7 string\n8 textText\n9 urlUrl\n10 choice\n11 open-choice\n12 quantity\n",
                "type": "display",
                "required": true
              }
            ]
          }
         ]
        }
      ]
      },
      //COMMENT -references the contained Questionnaire
      "questionnaire": {
        "reference": "#questionnaire-example-adaptive-sampler"
      },
      "status": "in-progress",
    ...[snipped for brevity]....
    //COMMENT -first group is display only so no scoring or processing by the Server
    "item": [
    {
      "linkId": "g1",
      "item": [
        {
          "linkId": "g1.d"
        }
       ]
      }
     ]
    }
  }
</code></pre></div></div>

<p><strong>response</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "resourceType": "QuestionnaireResponse",
  "id": "questionnaireresponse-example-adaptive-sampler",
  "meta": {
    "profile": [
      "http://fhir.org/guides/argonaut-questionnaire/StructureDefinition/argo-adap-questionnaireresponse"
    ],
  //COMMENT - contained Questionnaire
  "contained": [
    {
      "resourceType": "Questionnaire",
      "id": "questionnaire-example-adaptive-sampler",
      "meta": {
        "profile": [
          "http://fhir.org/guides/argonaut-questionnaire/StructureDefinition/argo-questionnaire"
        ]
      },
      //COMMENT -the 'url' element identifies the adaptive questionnaire - the set of questions for a particular adaptive questionnaire
      "url": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler",
      "title": "Argonaut Questionnaire Sampler",
      "status": "draft",
      ...[snipped for brevity]....
    //COMMENT -first item group is a display only
      "item": [
      {
        "linkId": "g1",
        //COMMENT - unique url for the Server to identify the adaptive questionnaire question for processing  (figure out what is the next question and/or calculating the score) this could also be a GUID.
        "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g1"
        "text": "Header Text",
        "type": "group",
        "required": true,
        "item": [
          {
            "linkId": "g1.d",
            //COMMENT - unique url for the Server to identify the adaptive questionnaire question for processing  (figure out what is the next question and/or calculating the score)
            "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g1.d"
            "text": "The Argonaut Questionnaire Sampler is designed to show all the question types that can be used in the Argonaut Questionnaire Project:\n\n1 boolean\n2 decimal\n3 integer\n4 dateDate\n5 dateTime\n6 timeTime\n7 string\n8 textText\n9 urlUrl\n10 choice\n11 open-choice\n12 quantity\n",
            "type": "display",
            "required": true
          }
        ]
      },
      //COMMENT -add next item group as next question
      {
        "linkId": "g2",
        "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g2"
        "type": "group",
        "item": [
          {
            "extension": [
              {
                "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-ordinalValue",
                "valueDecimal": 17
              }
            ],
            "linkId": "g2.q1",
            "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g2.q1"
            "text": "Check the box if the following statement is true.  The average air speed velocity of a laden European swallow is greater than a laden African swallow.",
            "type": "boolean",
            "required": true,
            "repeats": false
          }
        ]
      },

     ]
    }
  ]
  },
  //references the contained Questionnaire
  "questionnaire": {
    "reference": "#questionnaire-example-adaptive-sampler"
  },
  "status": "in-progress",
...[snipped for brevity]....
//first group is display only so no scoring or processing by the Server
"item": [
{
  "linkId": "g1",
  "item": [
    {
      "linkId": "g1.d"
    }
   ]
  }
 ]
}
</code></pre></div></div>

  </div>
</div>
<p><br /></p>

<p>
  <button class="btn-sm btn-info" type="button" title="Click to Open or Close Example" data-toggle="collapse" data-target="#example-aq-next2" aria-expanded="false" aria-controls="collapseExample">
    Example: $next-question Operation Returns Next Question and scoring
  </button>
</p>

<div class="collapse" id="example-aq-next2">
  <div class="card card-body">
      <p>Note that these json examples are annotated with nonstandard comments and snipped for brevity.</p>

<p><strong>request</strong></p>

<p><code class="highlighter-rouge">POST [base]/Questionnaire/questionnaire-example-adaptive-sampler/$next-question</code></p>

<p><strong>payload</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{"resourceType": "QuestionnaireResponse",
      "id": "questionnaireresponse-example-adaptive-sampler",
      "meta": {
        "profile": [
          "http://fhir.org/guides/argonaut-questionnaire/StructureDefinition/argo-adap-questionnaireresponse"
        ],
      //COMMENT - contained Questionnaire
      "contained": [
        {
          "resourceType": "Questionnaire",
          "id": "questionnaire-example-adaptive-sampler",
          "meta": {
            "profile": [
              "http://fhir.org/guides/argonaut-questionnaire/StructureDefinition/argo-questionnaire"
            ]
          },
          //COMMENT -the 'url' element identifies the adaptive questionnaire - the set of questions for a particular adaptive questionnaire
          "url": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler",
          "title": "Argonaut Questionnaire Sampler",
          "status": "draft",
          ...[snipped for brevity]....
          //COMMENT -first item group is a display only
          "item": [
          {
            "linkId": "g1",
            //COMMENT - unique url for the Server to identify the adaptive questionnaire question for processing  (figure out what is the next question and/or calculating the score) this could also be a GUID.
            "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g1",
            "text": "Header Text",
            "type": "group",
            "required": true,
            "item": [
              {
                "linkId": "g1.d",
                //COMMENT - unique url for the Server to identify the adaptive questionnaire question for processing  (figure out what is the next question and/or calculating the score)
                "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g1.d",
                "text": "The Argonaut Questionnaire Sampler is designed to show all the question types that can be used in the Argonaut Questionnaire Project:\n\n1 boolean\n2 decimal\n3 integer\n4 dateDate\n5 dateTime\n6 timeTime\n7 string\n8 textText\n9 urlUrl\n10 choice\n11 open-choice\n12 quantity\n",
                "type": "display",
                "required": true
              }
            ]
          },
          //COMMENT -second item group is a question
          {
            "linkId": "g2",
            "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g2",
            "type": "group",
            "item": [
              {
                "extension": [
                  {
                    "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-ordinalValue",
                    "valueDecimal": 17
                  }
                ],
                "linkId": "g2.q1",
                "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g2.q1",
                "text": "Check the box if the following statement is true.  The average air speed velocity of a laden European swallow is greater than a laden African swallow.",
                "type": "boolean",
                "required": true,
                "repeats": false
              }
            ]
          }
         ]
        }
      ]
      },
      //COMMENT -references the contained Questionnaire
      "questionnaire": {
        "reference": "#questionnaire-example-adaptive-sampler"
      },
      "status": "in-progress",
    ...[snipped for brevity]....
    //COMMENT -first group is display only so no scoring or processing by the Server
    "item": [
    {
      "linkId": "g1",
      "item": [
        {
          "linkId": "g1.d"
        }
       ]
      },
      //COMMENT -second group is question-answer pair added by client to be processed by the Server to determine the next question
      {
        "linkId": "g2",
        "item": [
          {
            "linkId": "g2.q1",
            "answer": [
              {
                "valueBoolean": false
              }
            ]
          }
        ]
      }

     ]
    }
}

</code></pre></div></div>

<p><strong>response</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "resourceType": "QuestionnaireResponse",
  "id": "questionnaireresponse-example-adaptive-sampler",
  "meta": {
    "profile": [
      "http://fhir.org/guides/argonaut-questionnaire/StructureDefinition/argo-adap-questionnaireresponse"
    ],
  //COMMENT - contained Questionnaire
  "contained": [
    {
      "resourceType": "Questionnaire",
      "id": "questionnaire-example-adaptive-sampler",
      "meta": {
        "profile": [
          "http://fhir.org/guides/argonaut-questionnaire/StructureDefinition/argo-questionnaire"
        ]
      },
      //COMMENT -the 'url' element identifies the adaptive questionnaire - the set of questions for a particular adaptive questionnaire
      "url": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler",
      "title": "Argonaut Questionnaire Sampler",
      "status": "draft",
      ...[snipped for brevity]....
      "item": [
      {
        "linkId": "g1",
        //COMMENT - unique url for the Server to identify the adaptive questionnaire question for processing  (figure out what is the next question and/or calculating the score) this could also be a GUID.
        "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g1",
        "text": "Header Text",
        "type": "group",
        "required": true,
        "item": [
          {
            "linkId": "g1.d",
            //COMMENT - unique url for the Server to identify the adaptive questionnaire question for processing  (figure out what is the next question and/or calculating the score)
            "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g1.d",
            "text": "The Argonaut Questionnaire Sampler is designed to show all the question types that can be used in the Argonaut Questionnaire Project:\n\n1 boolean\n2 decimal\n3 integer\n4 dateDate\n5 dateTime\n6 timeTime\n7 string\n8 textText\n9 urlUrl\n10 choice\n11 open-choice\n12 quantity\n",
            "type": "display",
            "required": true
          }
        ]
      },
      {
        "linkId": "g2",
        "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g2",
        "type": "group",
        "item": [
          {
            "extension": [
              {
                "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-ordinalValue",
                "valueDecimal": 17
              }
            ],
            "linkId": "g2.q1",
            "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g2.q1",
            "text": "Check the box if the following statement is true.  The average air speed velocity of a laden European swallow is greater than a laden African swallow.",
            "type": "boolean",
            "required": true,
            "repeats": false
          }
        ]
      },
      //COMMENT - add third item group as next question
      {
        "linkId": "g3",
        "type": "group",
        "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g3",
        "item": [
          {
            "extension": [
              {
                "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-ordinalValue",
                "valueDecimal": 7
              }
            ],
            "linkId": "g3.q1",
            "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g3",
            "text": "What is the average air speed velocity of a laden swallow in m/sec?",
            "type": "decimal",
            "required": true,
            "repeats": false
          }
        ]
      }
     ]
    }
  ]
  },
  //COMMENT -references the contained Questionnaire
  "questionnaire": {
    "reference": "#questionnaire-example-adaptive-sampler"
  },
  "status": "in-progress",
...[snipped for brevity]....
//COMMENT -first group is display only so no scoring or processing by the Server
"item": [
{
  "linkId": "g1",
  "item": [
    {
      "linkId": "g1.d"
    }
   ]
  },
  //COMMENT -second group is question-answer pair so processed by the Server to determine the next question
  {
    "linkId": "g2",
    "item": [
      {
        "linkId": "g2.q1",
        "answer": [
          {
            "valueBoolean": false
          }
        ]
      }
    ]
  }
 ]
}
</code></pre></div></div>

  </div>
</div>
<p><br /></p>

<!--------- done ------------>

<h3 id="adaptive-questionnaire-is-complete">Adaptive Questionnaire is Complete</h3>

<!-- all this Bootstrap html for getting an image to fit nicely in text - 640 pix wide -->

<!-- file:///assets/images/aw-step3.jpg -->

<div>
<figure class="figure">
<figcaption class="figure-caption"><strong></strong></figcaption>
  <img src="assets/images/aw-step3.jpg" class="figure-img-narrow img-responsive img-rounded center-block" alt="aw-step3.jpg" />
</figure>

<p></p>
</div>

<p>The Form Filler and Service repeat the process to get the next questions and answers as <a href="#get-next-question">described above</a>.</p>

<!-- all this Bootstrap html for getting an image to fit nicely in text - 640 pix wide -->

<!-- file:///assets/images/aqr_diagrams_e.svg -->

<div>
<figure class="figure">
<figcaption class="figure-caption"><strong></strong></figcaption>
  <img src="assets/images/aqr_diagrams_e.svg" class="figure-img-narrow img-responsive img-rounded center-block" alt="aqr_diagrams_e.svg" />
</figure>

<p></p>
</div>

<!-- all this Bootstrap html for getting an image to fit nicely in text - 640 pix wide -->

<!-- file:///assets/images/aqr_diagrams_f.svg -->

<div>
<figure class="figure">
<figcaption class="figure-caption"><strong></strong></figcaption>
  <img src="assets/images/aqr_diagrams_f.svg" class="figure-img-narrow img-responsive img-rounded center-block" alt="aqr_diagrams_f.svg" />
</figure>

<p></p>
</div>

<p>When the Service determines that the adaptive questionnaire is complete, instead of updating the Questionnaire with the next question, it updates the QuestionnaireResponse status to ‘completed’. The status of ‘completed’ signals to the Form Filler that the adaptive Questionnaire is done.  If scoring is done by the Service, the scores may be reported and updated for each transaction or reported once at the end as is shown in diagram below.</p>

<!-- all this Bootstrap html for getting an image to fit nicely in text - 640 pix wide -->

<!-- file:///assets/images/aqr_diagrams_g.svg -->

<div>
<figure class="figure">
<figcaption class="figure-caption"><strong></strong></figcaption>
  <img src="assets/images/aqr_diagrams_g.svg" class="figure-img-narrow img-responsive img-rounded center-block" alt="aqr_diagrams_g.svg" />
</figure>

<p></p>
</div>

<h4 class="no_toc" id="apis-2">APIs</h4>

<p>The following Argonaut Questionnaire artifacts are used in this transaction:</p>

<ul>
  <li><strong><a href="OperationDefinition-next-question.html" title="The Argonaut Next Question Operation is used for adaptive questionnaires forms where the next question is based on previous answers.">Argonaut Next Question Operation</a></strong></li>
  <li><strong><a href="StructureDefinition-argo-adap-questionnaireresponse.html" title="The Argonaut Adaptive QuestionnaireResponse Profile  is derived from the Argonaut QR profile requiring a containedArgonaut Questionnaire Profile to support the adaptive questionnaire use case.">Argonaut Adaptive QuestionnaireResponse Profile</a></strong></li>
</ul>

<h4 class="no_toc" id="usage-2">Usage</h4>

<p>To retrieve the finished adaptive questionnaire:</p>

<p><code class="highlighter-rouge">POST [base]/Questionnaire/$next-question</code></p>

<p>
  <button class="btn-sm btn-info" type="button" title="Click to Open or Close Example" data-toggle="collapse" data-target="#example-aq-done" aria-expanded="false" aria-controls="collapseExample">
    Example: $next-question Operation Returns Completed Adaptive Questionnaire
  </button>
</p>

<div class="collapse" id="example-aq-done">
  <div class="card card-body">
      <p>Note that these json examples are annotated with nonstandard comments and snipped for brevity.</p>

<p><strong>request</strong></p>

<p><code class="highlighter-rouge">POST [base]/Questionnaire/questionnaire-example-adaptive-sampler/$next-question</code></p>

<p><strong>payload</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{"resourceType": "QuestionnaireResponse",
    "id": "questionnaireresponse-example-adaptive-sampler",
    "meta": {
      "profile": [
        "http://fhir.org/guides/argonaut-questionnaire/StructureDefinition/argo-adap-questionnaireresponse"
      ],
    // contained Questionnaire
    "contained": [
      {
        "resourceType": "Questionnaire",
        "id": "questionnaire-example-adaptive-sampler",
        "meta": {
          "profile": [
            "http://fhir.org/guides/argonaut-questionnaire/StructureDefinition/argo-questionnaire"
          ]
        },
        //the 'url' element identifies the adaptive questionnaire - the set of questions for a particular adaptive questionnaire
        "url": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler",
        "title": "Argonaut Questionnaire Sampler",
        "status": "draft",
        ...[snipped for brevity]....
        "item": [
        {
          "linkId": "g1",
          //COMMENT - unique url for the Server to identify the adaptive questionnaire question for processing  (figure out what is the next question and/or calculating the score) this could also be a GUID.
          "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g1",
          "text": "Header Text",
          "type": "group",
          "required": true,
          "item": [
            {
              "linkId": "g1.d",
              //COMMENT - unique url for the Server to identify the adaptive questionnaire question for processing  (figure out what is the next question and/or calculating the score)
              "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g1.d",
              "text": "The Argonaut Questionnaire Sampler is designed to show all the question types that can be used in the Argonaut Questionnaire Project:\n\n1 boolean\n2 decimal\n3 integer\n4 dateDate\n5 dateTime\n6 timeTime\n7 string\n8 textText\n9 urlUrl\n10 choice\n11 open-choice\n12 quantity\n",
              "type": "display",
              "required": true
            }
          ]
        },
        {
          "linkId": "g2",
          "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g2",
          "type": "group",
          "item": [
            {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-ordinalValue",
                  "valueDecimal": 17
                }
              ],
              "linkId": "g2.q1",
              "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g2.q1",
              "text": "Check the box if the following statement is true.  The average air speed velocity of a laden European swallow is greater than a laden African swallow.",
              "type": "boolean",
              "required": true,
              "repeats": false
            }
          ]
        },
        //COMMENT - third item group is the current question
        {
          "linkId": "g3",
          "type": "group",
          "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g3",
          "item": [
            {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-ordinalValue",
                  "valueDecimal": 7
                }
              ],
              "linkId": "g3.q1",
              "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g3",
              "text": "What is the average air speed velocity of a laden swallow in m/sec?",
              "type": "decimal",
              "required": true,
              "repeats": false
            }
          ]
        }
       ]
      }
    ]
    },
    //COMMENT -references the contained Questionnaire
    "questionnaire": {
      "reference": "#questionnaire-example-adaptive-sampler"
    },
    "status": "in-progress",
  ...[snipped for brevity]....
  //COMMENT -first group is display only so no scoring or processing by the Server
  "item": [
  {
    "linkId": "g1",
    "item": [
      {
        "linkId": "g1.d"
      }
     ]
    },
    {
      "linkId": "g2",
      "item": [
        {
          "linkId": "g2.q1",
          "answer": [
            {
              "valueBoolean": false
            }
          ]
        }
      ]
    },
    },
    //COMMENT -third group question-answer pair updated by client to be processed by the Server to determine the next question and the score
    {
      "linkId": "g3",
      "item": [
        {
          "linkId": "g3.q1",
          "answer": [
            {
              "valueDecimal": 12.38
            }
          ]
        }
      ]
    }
   ]
  }
}

</code></pre></div></div>

<p><strong>response</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "resourceType": "QuestionnaireResponse",
  "id": "questionnaireresponse-example-adaptive-sampler",
  "meta": {
    "profile": [
      "http://fhir.org/guides/argonaut-questionnaire/StructureDefinition/argo-adap-questionnaireresponse"
    ],
  //COMMENT - contained Questionnaire
  "contained": [
    {
      "resourceType": "Questionnaire",
      "id": "questionnaire-example-adaptive-sampler",
      "meta": {
        "profile": [
          "http://fhir.org/guides/argonaut-questionnaire/StructureDefinition/argo-questionnaire"
        ]
      },
      //COMMENT -the 'url' element identifies the adaptive questionnaire - the set of questions for a particular adaptive questionnaire
      "url": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler",
      "title": "Argonaut Questionnaire Sampler",
      "status": "draft",
      ...[snipped for brevity]....
      "item": [
      {
        "linkId": "g1",
        //COMMENT - unique url for the Server to identify the adaptive questionnaire question for processing  (figure out what is the next question and/or calculating the score) this could also be a GUID.
        "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g1",
        "text": "Header Text",
        "type": "group",
        "required": true,
        "item": [
          {
            "linkId": "g1.d",
            //COMMENT - unique url for the Server to identify the adaptive questionnaire question for processing  (figure out what is the next question and/or calculating the score)
            "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g1.d",
            "text": "The Argonaut Questionnaire Sampler is designed to show all the question types that can be used in the Argonaut Questionnaire Project:\n\n1 boolean\n2 decimal\n3 integer\n4 dateDate\n5 dateTime\n6 timeTime\n7 string\n8 textText\n9 urlUrl\n10 choice\n11 open-choice\n12 quantity\n",
            "type": "display",
            "required": true
          }
        ]
      },
      {
        "linkId": "g2",
        "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g2",
        "type": "group",
        "item": [
          {
            "extension": [
              {
                "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-ordinalValue",
                "valueDecimal": 17
              }
            ],
            "linkId": "g2.q1",
            "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g2.q1",
            "text": "Check the box if the following statement is true.  The average air speed velocity of a laden European swallow is greater than a laden African swallow.",
            "type": "boolean",
            "required": true,
            "repeats": false
          }
        ]
      },
      //COMMENT - third item group is the current question
      {
        "linkId": "g3",
        "type": "group",
        "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g3",
        "item": [
          {
            "extension": [
              {
                "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-ordinalValue",
                "valueDecimal": 7
              }
            ],
            "linkId": "g3.q1",
            "definition": "http://fhir.org/guides/argonaut-questionnaire/Questionnaire/questionnaire-example-adaptive-sampler#g3",
            "text": "What is the average air speed velocity of a laden swallow in m/sec?",
            "type": "decimal",
            "required": true,
            "repeats": false
          }
        ]
      },
      //COMMENT - add a readOnly hidden score question to a final item group.
      {
        "linkId": "g4",
        "type": "group",
        "item": [
          {
            "extension": [
              {
                "url": "http://fhir.org/guides/argonaut-questionnaire/StructureDefinition/extension-hidden",
                "valueBoolean": true
              }
            ],
            "linkId": "g4.q1",
            "text": "The total score is:",
            "type": ,
            "required": true,
            "repeats": false,
            "readOnly": true
            }
          }
        ]
      }
     ]
    }
  ]
  },
  //COMMENT -references the contained Questionnaire
  "questionnaire": {
    "reference": "#questionnaire-example-adaptive-sampler"
  },
  //COMMENT - status of ‘complete’ is a signal to the Client that the adaptive Questionnaire is done!  
  "status": "complete",
...[snipped for brevity]....
"item": [
{
  "linkId": "g1",
  "item": [
    {
      "linkId": "g1.d"
    }
   ]
  },
  {
    "linkId": "g2",
    "item": [
      {
        "linkId": "g2.q1",
        "answer": [
          {
            "valueBoolean": false
          }
        ]
      }
    ]
  },
  },
  {
    "linkId": "g3",
    "item": [
      {
        "linkId": "g3.q1",
        "answer": [
          {
            "valueDecimal": 12.38
          }
        ]
      }
    ]
  },
  //COMMENT - add a readOnly hidden score question to a final item group.
  {
    "linkId": "g4",
    "item": [
      {
        "linkId": "g4.q1",
        "answer": [
          {
            "valueQuantity": {
              "value" : 24,
              "unit" : "points",
              "system" : "http://unitsofmeasure.org",
              "code" : "\{score\}"
            }
          }
        ]
      }
    ]
  }
 ]
}
</code></pre></div></div>

  </div>
</div>
<p><br /></p>

<h3 id="questionnaireresponse-and-scoring">QuestionnaireResponse and Scoring</h3>

<p>When the adaptive questionnaire is complete, the Form Filler processes the QuestionnaireResponse with a contained Questionnaire based on the questions it was returned by the service.  The Form Filler may represent the cumulative or intermediate scores as answers as separate Observations.  The Form Filler may post the responses to an Answer Bank and perform searches on the QuestionnaireResponse as described in the <a href="static.html">Static Forms Use Case</a>.</p>

<h3 id="examples-and-reference-implementation">Examples and Reference Implementation</h3>

<p>Examples of completed Adaptive QuestionnaireResponses which demonstrate use of all the extensions and support elements as well as many of the question types can be found on the <a href="StructureDefinition-argo-adap-questionnaireresponse.html" title="The Argonaut Adaptive QuestionnaireResponse Profile  is derived from the Argonaut QR profile requiring a containedArgonaut Questionnaire Profile to support the adaptive questionnaire use case.">Argonaut Adaptive QuestionnaireResponse Profile</a> page.  In addition, the <a href="http://gettingstarte-cjfwz-env.us-west-2.elasticbeanstalk.com/">Argonaut Questionnaire Test Renderer</a> simulates the adaptive form workflow.</p>

<h3 id="amending-and-revising-adaptive-forms">Amending and Revising Adaptive Forms</h3>

<h4 class="no_toc" id="end-user-wishes-to-go-back-and-revise-an-answer-to-question">End User wishes to go back and revise an answer to Question</h4>
<p>For adaptive forms it needs to be emphasized that it is a <em>stateless</em> process for both the “black box” Service and the Form Filler.  That means that the Service processes the entire question-answer tree each time from the beginning and the Form Filler re-renders the informations each time.  So any question-answer pair or calculated results can change until the form is completed.  The Service may mark some question-answer pairs as <a href="http://hl7.org/fhir/STU3/questionnaire-definitions.html#Questionnaire.item.readOnly" title="An indication, when true, that the value cannot be changed by a human respondent to the Questionnaire."><code class="highlighter-rouge">readOnly</code></a> which instruct the Form Filler that they can not be subsequently altered.   If not marked as <code class="highlighter-rouge">readOnly</code>, any response can be changed at any time by the Form Filler and the Service will process normally and may remove subsequent question-answers as necessary based on its logic.   The Form Filler will be presented with the question-answer pairs and render it anew as well - i.e., it shall not retained the previous information.</p>

<h4 class="no_toc" id="answer-in-error-and-needs-to-be-reentered">Answer in Error and Needs to be Reentered</h4>

<p>For adaptive forms refer to the API on <a href="http://hl7.org/fhir/STU3/operations.html">FHIR operation</a>.  An <a href="http://hl7.org/fhir/STU3/operationoutcome.html">OperationOutcome</a> with the location of the error represented in the ‘expression element’ and a human readable error message should be returned.</p>

<h4 class="no_toc" id="technical-error">Technical Error</h4>
<p>Technical errors are typically handled by lower level protocols or manual processes. Typically the Form Filler or Service would simply resubmit the  QuestionnaireResponse.</p>

<p><br /></p>

<hr />

<div class="footnotes">
  <ol>
    <li id="fn:5">
      <p>How to implement Questionnaire  to design forms that adjust what information is displayed and/or that perform calculations based on user input is covered in the <a href="http://hl7.org/fhir/us/sdc/history.html" title="Defines expectations for sharing of Questionnaires and answers, including mechanisms for automatically populating portions of a questionnaire based on embedded mappings to underlying data elements">SDC (Structured Data Capture)</a> implementation Guide. <a href="#fnref:5" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>


  <!-- ==============END CONTENT END CONTENT=================== -->

</div>  <!-- col -->
</div>  <!-- /inner-wrapper -->
</div>  <!-- /row -->
</div>  <!-- /container -->
</div>  <!-- /page content -->
</div>  <!-- /page content wrapper -->



</div>

    </div>  <!-- /inner-wrapper -->
            </div>  <!-- /row -->
        </div>  <!-- /container -->

    </div>  <!-- /segment-content -->

<!-- back to top arrow -->

<a id="back-to-top" href="#" class="btn btn-info btn-lg back-to-top" role="button" title="Click to return on the top page" data-toggle="tooltip" data-placement="left"><span class="glyphicon glyphicon-chevron-up"></span></a>


<!-- end back to top arrow -->

<div id="segment-footer" class="segment"  igtool="footer">  <!-- segment-footer -->
  <div class="container">  <!-- container -->
   <div class="inner-wrapper">
    <p>
     <a href="http://argonautwiki.hl7.org">Argonaut Project </a> #1.0.0 based on <a style="color: #81BEF7" href="http://hl7.org/fhir/STU3/">FHIR v3.0.1</a> generated Mar 19, 2019. <br/>
      Links: <a style="color: #81BEF7" href="toc.html">Table of Contents</a>
      | <a style="color: #81BEF7" href="qa.html">QA Report</a>
      | <a style="color: #81BEF7" href="#">Version History</a>
      | <a style="color: #81BEF7" rel="license" href="http://hl7.org/fhir/STU3/license.html"><img style="border-style: none;" alt="CC0" src="cc0.png"/></a>
      | <a style="color: #81BEF7" href="https://github.com/argonautproject/questionnaire/issues" target="_blank">Propose a change</a>
        </p>
   </div>  <!-- /inner-wrapper -->
  </div>  <!-- /container -->
 </div>  <!-- /segment-footer -->
  <!-- disqus thread -->
  <!-- disqus -->
  <!-- end disqus -->

 <div id="segment-post-footer" class="segment hidden">  <!-- segment-post-footer -->
  <div class="container">  <!-- container -->
  </div>  <!-- /container -->
 </div>  <!-- /segment-post-footer -->

 <!-- JS and analytics only. -->
<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="./assets/js/jquery.min.js"> </script>     <!-- note keep space here, otherwise it will be transformed to empty tag -> fails -->
<script src="./assets/js/bootstrap.min.js"> </script>
<script src="./assets/js/respond.min.js"> </script>
<script src="./assets/js/anchor.min.js"> </script>
<script src="./assets/js/fhir.js"> </script>


<script src="./assets/js/topofpage.js"> </script>




<script src="assets/js/clipboard.min.js"> </script>

<script>
  // Tooltip

  $('#copy-button').tooltip({
    trigger: 'click',
    placement: 'bottom'
  });

  function setTooltip(message) {
    $('#copy-button').tooltip('hide')
      .attr('data-original-title', message)
      .tooltip('show');
  }

  function hideTooltip() {
    setTimeout(function() {
      $('#copy-button').tooltip('hide');
    }, 1000);
  }

  // Clipboard

  var clipboard = new ClipboardJS('#copy-button');

  clipboard.on('success', function(e) {
    setTooltip('Copied!');
    hideTooltip();
  });

  clipboard.on('error', function(e) {
    setTooltip('Failed!');
    hideTooltip();
  });

</script>



<!-- Analytics Below
================================================== -->

<!-- add anchors before the closing body tag -->
<script>
anchors.add()
</script>

</body>
</html>

