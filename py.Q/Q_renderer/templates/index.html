{% extends 'base.html' %}

<!-- macros --->


{% macro choice_type(j) %}
  {% for k in j.option %}
    {% if k.valueCoding %}
       <input type='radio' value='{{k.valueCoding.display}}' name='{{j.text}}' />{{ k.valueCoding.display}}<br />
    {% else %}
        <input type='radio' value='{{k.valueString}}' name='{{j.text}}' />{{ k.valueString}}<br />
    {% endif %}
  {% endfor %}
{% endmacro %}


<!-- select Q --->

{% block content %}


  <p>
    This application uses the <i>{{ref_server_name}}</i> FHIR reference implementation at <code>{{ref_server}}</code> as the Questionnaire Form Manager.</p>

<h4>Example Questionnaires available for testing:</h4>
  <form name="myForm" action="" method="post">
    <input type="radio" name="options" id="option1" value="{{ ref_server }}Questionnaire/questionnaire-example-audit"> The Alcohol Use Disorder Identification Test (AUDIT)Form</input><br>
    <input type="radio" name="options" id="option2" value="{{ ref_server }}Questionnaire/questionnaire-example-asq3"> Ages and Stages Questionnaire (ASQ-3) Sample 16 Month Questionnaire</input><br>
    <input type="radio" name="options" id="option3" value="{{ ref_server }}Questionnaire/questionnaire-example-dast"> Drug Abuse Screening Test (DAST-10)</input><br>
    <input type="radio" name="options" id="option4" value="{{ ref_server }}Questionnaire/questionnaire-example-housing"> Housing Instability Questionnaire</input><br>
    <input type="radio" name="options" id="option5" value="{{ ref_server }}Questionnaire/questionnaire-example-phq9"> Patient Health Questionnaire-9 (PHQ-9)</input><br>

  <br>
  <input type="submit" value="Choose Example Questionnaire">
</form>


<!-- end select Q --->

<!-- Q content -->
{% if q %}
<a href="{{ ref_server }}Questionnaire/{{q.id}}">Questionnaire as XML</a>
<br />
<a href="{{ url_for("q_view") }}">Questionnaire as JSON</a>
<h3>{{q.title}}</h3>
<hr />
<p><i>Copyright information: {{q.copyright|safe}}</i></p>
<br /><br />
<form action='{{url_for('quiz') }}' method='POST'>
  {% if q.item[0].prefix %}
    <ol style = 'list-style: none;'>
  {% else %}
    <ol style >
    {% endif %}
        {% for i in q.item %}
            <li id='{{i.linkId}}'><strong>{{i.prefix|default('', true)}}</strong> {{i.text}}</li>
            <br />
            {% if i.type == "group" %}
            {% for j in i.item %}
                <li id='{{j.linkId}}'><strong>{{j.prefix|default('', true)}}</strong> {{j.text}}</li>
                <br />
                {% if j.type == "choice" and j.option %}
                      {{ choice_type(j) }}  <!-- macro --->
                  <br />
                {% endif %}
              {% endfor %}

           {% elif i.type == "choice" and i.option %}
                  {{ choice_type(i) }}
            {% endif %}

  <br /><br /><hr /><br />

        {% endfor %}
    </ul>
    <input type="submit" value="submit" />
</form>
<hr />
<!--  End Q content -->

{% endif %}

{% endblock %}
